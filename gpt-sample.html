<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>位置情報と進行方向のWebアプリ</title>
    <style>
        /* スタイルの追加 */
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>位置情報と進行方向</h1>
    <p>位置情報を取得して、進行方向を把握します。</p>

    <button id="startButton">位置情報を取得</button>
    
    <div id="locationInfo">
        <p>進行方向: <span id="direction"></span></p>
    </div>

    <script>
        let watchId;
        let lastPosition;

        document.getElementById("startButton").addEventListener("click", startLocationUpdates);

        function startLocationUpdates() {
            if ("geolocation" in navigator) {
                watchId = navigator.geolocation.watchPosition(updateLocation);
            } else {
                alert("位置情報を取得できません。");
            }
        }

        function updateLocation(position) {
            const currentLocation = {
                latitude: position.coords.latitude,
                longitude: position.coords.longitude
            };

            if (lastPosition) {
                const direction = calculateDirection(lastPosition, currentLocation);
                document.getElementById("direction").textContent = `進行方向: ${direction}度`;
            }

            lastPosition = currentLocation;
        }

        function calculateDirection(prevLocation, currentLocation) {
            // 2つの位置情報間の方向を計算
            const lat1 = prevLocation.latitude;
            const lon1 = prevLocation.longitude;
            const lat2 = currentLocation.latitude;
            const lon2 = currentLocation.longitude;
            const angle = Math.atan2(lat2 - lat1, lon2 - lon1);
            const degrees = (angle * 180) / Math.PI;
            return degrees;
        }
    </script>
</body>
</html>
